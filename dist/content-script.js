(()=>{const s="focus-forge-overlay";if(document.getElementById(s))return;let a=null;const c=document.createElement("div");c.id=s,c.className="ff-overlay";const o=document.createElement("div");o.className="ff-content";const p=document.createElement("h1");p.textContent="Time for a break!";const f=document.createElement("p");f.textContent="To unlock, please use the Focus Forge popup.";const l=document.createElement("div");l.className="ff-timer-container";const u=document.createElement("div");u.className="ff-breathing-halo";const i=document.createElement("div");i.className="ff-timer-text",i.textContent="--:--",l.appendChild(u),l.appendChild(i);const r=document.createElement("div");r.className="ff-pixel-bar-container";const h=30;for(let e=0;e<h;e++){const t=document.createElement("div");t.className="ff-pixel",r.appendChild(t)}o.appendChild(p),o.appendChild(l),o.appendChild(r),o.appendChild(f),c.appendChild(o);const v=e=>{if(e<=0)return"00:00";const t=Math.round(e/1e3),n=Math.floor(t/60),m=t%60;return`${String(n).padStart(2,"0")}:${String(m).padStart(2,"0")}`},E=(e,t)=>{const n=e-Date.now();i.textContent=v(n);const m=t-n,C=Math.min(m/t,1),T=Math.floor(C*h),g=r.children;for(let d=0;d<g.length;d++)g[d].classList.toggle("filled",d<T);n<=0&&a&&clearInterval(a)};document.body.appendChild(c),chrome.runtime.sendMessage({command:"GET_TIMER_DATA"},e=>{e&&e.state==="BREAKING"&&chrome.storage.local.get("settings",({settings:t})=>{const n=(t.breakDuration||5)*60*1e3;E(e.endTime,n),a=window.setInterval(()=>E(e.endTime,n),1e3)})}),chrome.runtime.onMessage.addListener(e=>{if(e.type==="TIMER_UPDATED"&&e.data.state==="IDLE"){a&&clearInterval(a);const t=document.getElementById(s);t&&t.remove()}})})();
